<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A&M INTERNATIONAL ENGINEERING PTE LTD</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 您的所有原有样式保持不变... */
        
        /* 搜索栏样式 */
        .search-container {
            display: flex;
            align-items: center;
            background: white;
            border-radius: 25px;
            padding: 2px;
            border: 1px solid #ccc;
        }

        .search-input {
            border: none;
            outline: none;
            padding: 8px 15px;
            border-radius: 25px;
            width: 200px;
            font-size: 14px;
            background: transparent;
        }

        .search-button {
            background: #00b4d8;
            border: none;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 2px;
            transition: background 0.3s ease;
        }

        .search-button:hover {
            background: #0099b8;
        }

        .search-icon {
            width: 16px;
            height: 16px;
            object-fit: contain;
        }
    </style>
</head>

<body>
    <div id="header-placeholder"></div>

    <script>
        // 搜索功能函数 - 支持站内和站外搜索
        function performSearch() {
            console.log('performSearch function called');
            const searchInput = document.getElementById('search-input');
            const query = searchInput ? searchInput.value.trim() : '';
            console.log('Search query:', query);
            
            if (query) {
                // 首先尝试站内搜索
                const isInternalSearch = searchInternally(query);
                
                // 如果没有站内结果，进行站外搜索
                if (!isInternalSearch) {
                    searchExternally(query);
                }
            } else {
                alert('Please enter search keywords');
            }
        }

        // 站内搜索函数
        function searchInternally(query) {
            console.log('Checking internal search for:', query);
            const internalKeywords = [
                'automation', 'integration', 'solutions', 'security', 'compliance',
                'engineering', 'project', 'control', 'measurement', 'digital',
                'transformation', 'supply chain', 'optimization', 'risk management',
                'intelligent', 'iot', 'scada', 'plc', 'maintenance', 'monitoring'
            ];
            
            const lowerQuery = query.toLowerCase();
            
            // 检查是否是站内相关关键词
            const isInternal = internalKeywords.some(keyword => 
                lowerQuery.includes(keyword)
            );
            
            console.log('Is internal search:', isInternal);
            
            if (isInternal) {
                // 跳转到搜索结果页面
                window.location.href = `search.html?query=${encodeURIComponent(query)}`;
                return true;
            }
            
            return false;
        }

        // 站外搜索函数
        function searchExternally(query) {
            console.log('Performing external search for:', query);
            // 使用Google进行站外搜索
            const googleSearchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
            window.open(googleSearchUrl, '_blank');
        }

        // 初始化搜索功能 - 修复版
        function initSearchFunctionality() {
            console.log('=== Initializing search functionality ===');
            
            // 直接通过ID查找元素
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            
            console.log('Search input element:', searchInput);
            console.log('Search button element:', searchButton);
            
            if (searchInput && searchButton) {
                console.log('Both search elements found, setting up event listeners...');
                
                // 先移除所有可能存在的旧事件监听器
                searchButton.replaceWith(searchButton.cloneNode(true));
                const newButton = document.getElementById('search-button');
                
                // 设置点击事件
                newButton.addEventListener('click', function(e) {
                    console.log('Search button clicked!');
                    e.preventDefault();
                    e.stopPropagation();
                    performSearch();
                });
                
                // 设置Enter键事件
                searchInput.addEventListener('keypress', function(e) {
                    console.log('Key pressed:', e.key);
                    if (e.key === 'Enter') {
                        console.log('Enter key detected!');
                        e.preventDefault();
                        e.stopPropagation();
                        performSearch();
                    }
                });
                
                console.log('Event listeners set up successfully');
                
                // 测试：手动触发搜索功能
                window.testSearch = function() {
                    console.log('Manual test triggered');
                    performSearch();
                };
                
            } else {
                console.error('Search elements not found:');
                console.error('- Input:', searchInput);
                console.error('- Button:', searchButton);
                
                // 尝试查找所有按钮
                const allButtons = document.querySelectorAll('button');
                console.log('All buttons on page:', allButtons);
                
                // 尝试通过类名查找
                const searchButtons = document.querySelectorAll('.search-button');
                console.log('Buttons with search-button class:', searchButtons);
            }
        }

        // 加载header
        fetch('header.html')
            .then(response => {
                if (!response.ok) {
                    throw new Error('header.html not found');
                }
                return response.text();
            })
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                console.log('Header loaded successfully');
                
                // 多次尝试初始化，确保DOM完全加载
                setTimeout(() => {
                    console.log('First initialization attempt...');
                    initSearchFunctionality();
                }, 100);
                
                setTimeout(() => {
                    console.log('Second initialization attempt...');
                    initSearchFunctionality();
                }, 500);
                
                setTimeout(() => {
                    console.log('Third initialization attempt...');
                    initSearchFunctionality();
                }, 1000);
            })
            .catch(error => {
                console.error('Error loading header:', error);
                // 如果header.html不存在，提供基本的header结构
                document.getElementById('header-placeholder').innerHTML = `
                    <header style="padding: 1rem; background: #333; color: white;">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                            <h1 style="margin: 0 1rem 1rem 0;">A&M INTERNATIONAL ENGINEERING</h1>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <a href="contact.html" style="color: white; text-decoration: none;">Contact Us</a>
                                <div class="search-container">
                                    <input type="text" id="search-input" placeholder="Search..." class="search-input">
                                    <button id="search-button" class="search-button" type="button">
                                        <img src="Image/search-icon.png" alt="Search" class="search-icon">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>
                `;
                console.log('Fallback header loaded');
                
                // 多次尝试初始化
                setTimeout(() => {
                    console.log('Fallback initialization attempt...');
                    initSearchFunctionality();
                }, 100);
            });

        // 页面完全加载后再次初始化
        window.addEventListener('load', function() {
            console.log('Window loaded, final initialization attempt...');
            setTimeout(initSearchFunctionality, 300);
        });

        // DOM内容加载完成后也初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM content loaded, initialization attempt...');
            setTimeout(initSearchFunctionality, 200);
        });
    </script>

    <!-- 以下所有内容保持不变 -->
    <section class="business-concept">
        <div class="concept-card automation-bg">
            <h2>Intelligent & Automated Integration</h2>
            <p>Intelligent & Automated Integration refers to our approach of combining smart technologies, real-time data connectivity, and advanced automation to deliver seamless, scalable, and efficient engineering systems. By integrating IIoT, PLCs, SCADA, and cloud platforms, we enable intelligent control, predictive maintenance, and real-time monitoring across diverse industrial applications—enhancing performance, reducing downtime, and supporting future expansion.</p>
        </div>

        <div class="concept-card solutions-bg">
            <h2>End-to-End Solutions</h2>
            <p> We deliver comprehensive end-to-end solutions that span the entire project lifecycle — from concept design and engineering to seamless implementation, commissioning, and ongoing maintenance. Our approach ensures reliable, efficient, and fully customized systems tailored to meet the specific operational and regulatory requirements of diverse industries. By integrating technical expertise with industry best practices, we empower our clients to achieve sustainable performance and long-term value.</p>
        </div>

        <div class="concept-card security-bg">
            <h2>Security & Compliance</h2>
            <p>Security & Compliance
We prioritize the highest standards of security and compliance by ensuring that all systems we design and implement fully adhere to internationally recognized standards, including ASME, ATMS, AGA, and LR. Our approach guarantees that every project not only meets regulatory requirements but also operates with the utmost stability and security. By focusing on these critical aspects, we provide our clients with systems that are resilient, reliable, and future-proof, helping them navigate complex regulatory landscapes and ensure long-term operational success in diverse industries.</p>
        </div>
    </section>

    <section class="footer-menu">
        <!-- Footer内容保持不变 -->
    </section>

    <footer>
        <p>&copy; 2025 A&M INTERNATIONAL ENGINEERING PTE LTD. All rights reserved.</p>
    </footer>

    <!-- 添加search.js引用 -->
    <script src="search.js"></script>
</body>
</html>
